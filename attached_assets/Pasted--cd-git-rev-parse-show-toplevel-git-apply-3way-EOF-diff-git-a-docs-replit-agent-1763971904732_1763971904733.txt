 (cd "$(git rev-parse --show-toplevel)" && git apply --3way <<'EOF' 
diff --git a/docs/replit-agent-prompt.md b/docs/replit-agent-prompt.md
new file mode 100644
index 0000000000000000000000000000000000000000..3422cca766a079c659d5ac319c7e4b2569e5bca5
--- /dev/null
+++ b/docs/replit-agent-prompt.md
@@ -0,0 +1,39 @@
+# Replit Agent Implementation Prompt
+
+Implement the following changes to strengthen the lead→cash pipeline, match leading business management software, and improve UX.
+
+## Lead → Quote → Job → Invoice → Payment Automation
+- Auto-convert approved quotes into draft jobs with scheduled placeholders.
+- Auto-create draft invoices when jobs move to **Completed**, prefilled from job line items and time entries.
+- Add invoice due-date–driven reminders (dunning) and scheduled quote follow-ups; expose automation toggles in settings with audit logging of generated records.
+- Require client/property association before allowing stage transitions; provide one-click "Convert" CTAs that carry context (contacts, property, pricing) forward.
+
+## Payments & Financials
+- Integrate real payments (Stripe) with payment links, partial payments, and card-on-file; map payments to `payment_records` with auditability.
+- Show invoice aging buckets (Current/30/60/90) with balance summaries and actions (record partial, send reminder).
+
+## Navigation & Discoverability
+- Restructure the sidebar into grouped sections: Sales (Leads/Quotes/AI Estimator/Marketing), Work (Dashboard/Calendar/Jobs/Templates/Forms), Finance (Invoices/Payments/Payroll/Profitability), Operations (Crews/Time Tracking/Equipment/Employees), AI & Support (AI Core/Chat), Admin (Settings). Consider collapsible groups; pin high-usage items.
+- Add global search to jump to entities (lead, quote, job, invoice, client/property) from anywhere.
+
+## Security, Roles, and Reliability
+- Add role-based access (admin/manager/crew/sales) with scoped data access and audit logging for sensitive actions.
+- Implement CSRF protection, input validation, and rate limiting on APIs.
+- Ensure soft-deleted records are consistently filtered out; add global search and validation to avoid orphaned records.
+
+## Workflow Quality Controls
+- Enforce job preflight (required job forms/JHA before "In Progress"); expand job templates to prefill crew/equipment/time expectations from quote line items.
+- Surface quote version metadata on jobs; maintain state color/badge consistency across quote/job/invoice UIs.
+
+## Observability & Exception Handling
+- Build a pipeline board (Lead→Quote→Job→Invoice→Payment) with conversion rates and SLA timers.
+- Add exception queues: quotes awaiting approval, jobs missing invoices, invoices overdue; include bulk actions (convert, send reminder, schedule).
+
+## UX Polish & Defaults
+- Smart defaults for primary property/contact selection during conversions.
+- Inline AI actions: generate quote from photos, summarize scope for crew, draft invoice notes.
+- Consistent loading/error states and mobile-friendly tables/cards across pages.
+
+## Testing & Structure
+- Add E2E tests that cover quote→job→invoice→payment to validate storage end-to-end.
+- Refactor oversized backend server file into domain routes/services if still monolithic; keep error handling and logging intact.
 
EOF
)